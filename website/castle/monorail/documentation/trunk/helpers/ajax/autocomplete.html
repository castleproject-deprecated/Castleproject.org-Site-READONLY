<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">









<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
		<title>Auto completion :: Castle Project</title>
		<link rel="stylesheet" href="../../../../../base.css" />
		<link rel="stylesheet" href="../../../../../front.css" />
		<link rel="stylesheet" href="../../../../../elem.css" />
		<link rel="stylesheet" href="../../../../../csharp.css" />
		<link rel="stylesheet" href="../../../../../TAB_styles.css" />
		<script type="text/javascript" src="../../../../../mktree.js"></script>
		<script type="text/javascript" src="../../../../../TAB_Function_Lib.js"></script>
		<script src="http://www.google-analytics.com/urchin.js" type="text/javascript"></script>
	</head>

	<body>
<div id="topheader">
  <div id="maintitle">
	<h1> <a href="../../../../../index.html" title="Castle Project Home" accesskey="1">Home</a> </h1>
	<h2> <a href="http://www.castlestronghold.com" title="Castle Stronghold: support, consulting and development">Castle Stronghold</a> </h2>
  </div>
  <div id="mainbar">
	<ul id="toplinks">
		<li>&nbsp;</li>
		<li><a style="_width: 70px;" href="../../../../../index.html">Home</a></li>
		<li><a style="_width: 70px;" href="../../../../../castle/projects.html">Projects</a></li>
		<li><a style="_width: 70px;" href="../../../../../castle/download.html">Downloads</a></li>
		<li><a style="_width: 110px;" href="http://api.castleproject.org">API Doc</a></li>
		<li><a style="_width: 50px;" href="http://using.castleproject.org">Using</a></li>
		<li><a style="_width: 60px;" href="../../../../../community/mailinglists.html">Mailing Lists</a></li>
		<li><a style="_width: 120px;" href="../../../../../issuetracker.html">Issue Tracker</a></li>
		<li><a style="_width: 110px;" href="http://builds.castleproject.org">Builds</a></li>
	</ul>
  </div>
</div>



<div id="coolpage">

	<div id="sidebar" >
		
  <div class="lightmenu">
    <div class="lightmenucontent">
<span class="menutitle">
<a href="./../../../../../monorail/index.html">MonoRail</a>
</span>
  <ul>
<li>
<a href="./../../../../../monorail/gettingstarted/index.html">Getting started</a>
</li>
<li>
<a href="./../../../../../monorail/faq.html">FAQ</a>
</li>
<li>
<a href="./../../../../../monorail/recipes/index.html">Recipes</a>
</li>
<li>
<a href="./../../../../../monorail/externalarticles.html">External Articles</a>
</li>
  </ul>
    </div>
  </div>
  <br/>
  <div class="lightmenu">
    <div class="lightmenucontent">
<span class="menutitle">
<a href="./../../../../../monorail/documentation/trunk/index.html">Documentation</a>
</span>
  <ul>
<li>
<a href="./../../../../../monorail/documentation/trunk/releasenotes/index.html">Release notes</a>
</li>
<li>
<a href="./../../../../../monorail/documentation/trunk/manual/index.html">Reference Manual</a>
</li>
<li>
<a href="./../../../../../monorail/documentation/trunk/usersguide/index.html">User's Guide</a>
</li>
<li>
<a href="./../../../../../monorail/documentation/trunk/advanced/index.html">Advanced usage</a>
</li>
  </ul>
    </div>
  </div>
  <br/>
  <div class="darkmenu">
    <div class="darkmenucontent">
<span class="menutitle">
Navigation
</span>
  <ul>
<li>
<a href="./../../../../../index.html">Back to Main Page</a>
</li>
  </ul>
    </div>
  </div>
  <br/>
	<br/>
	
	</div>
		
	<div id="content">
	
		<div class="callout-pic">

<!-- Begin Table of contents -->
<!-- End Table of contents -->
		</div>

		<h1 class="firstHeading">
		    Auto completion
		</h1> 
	
<div class="breadcrumbs">
&raquo;
	<a href="./../../../../../index.html">Home</a> 
&raquo;
	<a href="./../../../../../monorail/index.html">MonoRail</a> 
&raquo;
	<a href="./../../../../../monorail/documentation/index.html">Documentation</a> 
&raquo;
	<a href="./../../../../../monorail/documentation/trunk/index.html">MonoRail trunk Documentation</a> 
&raquo;
	<a href="./../../../../../monorail/documentation/trunk/helpers/index.html">MonoRail Helpers</a> 
&raquo;
	<a href="./../../../../../monorail/documentation/trunk/helpers/ajax/index.html">AjaxHelper</a> 
&raquo;
<u>Auto completion</u>
</div>

		<!-- start content -->
<p>
The AutoComplete enables a google style search where
partial searches are emitted as you type.
</p><p>
		It is higly advisable to carefully read the script.aculo.us 
		<a href="http://wiki.script.aculo.us/scriptaculous/show/Ajax.Autocompleter" >documentation</a> 
		for the AutoCompleter to know about the possible completionOptions.
	</p><p>
		AjaxHelper offers the following methods for providing AutoCompletion:
<ul><li><tt>InputTextWithAutoCompletion(IDictionary parameters, IDictionary tagAttributes)</tt></li><li><tt>InputTextWithAutoCompletion(String inputName, String url, IDictionary tagAttributes, IDictionary completionOptions)</tt></li><li><tt>AutoCompleteInputText( String elementId, String url, IDictionary options )</tt></li></ul></p><p>
	FormHelper also offers a combination of a input field with databinding behaviour and
	Ajax Autocomplete behaviour.
	<ul><li><tt>FormHelper.TextFieldAutoComplete(string target, string url, IDictionary tagAttributes, IDictionary completionOptions)</tt></li></ul>
	This field is created analogous to <tt>InputTextWithAutoCompletion</tt>, but instead of an inputName, the
	target object's property path is specified (i.e. <tt>user.Role</tt>).
</p><a name="usage"></a>
  <h1>Usage Example</h1>
<p>Ok, let me directly start with the code:</p>  <div class="tabWrapper" id="tabcontent1">
<ul class="tabbedNavOff" id="tabcontent1_tabs">
	<li><a class="" id="tabtabcontent1_1" href="#tabcontent1-1" onclick="return tabcontent1Tab.switchTab(this.id,false)"><span><span>Brail</span></span></a></li>
	<li><a class="" id="tabtabcontent1_2" href="#tabcontent1-2" onclick="return tabcontent1Tab.switchTab(this.id,false)"><span><span>NVelocity</span></span></a></li>
</ul>
<div class="tabSpacerOff" id="tabcontent1_spacer">&nbsp;</div>
	<div class="tabBox" id="tabcontent1-1">
<div class="tabBoxGutter">
    <pre class="csharpcode">

<span class="asp">&lt;%</span> 
ajaxOpt = {@parameters: <span class="str">"{user:'${user.Id}'}"</span>, @paramName:<span class="str">'"search"'</span>}
inputOpt = {@<span class="kwrd">class</span>: <span class="str">'txt'</span>}
<span class="asp">%&gt;</span>
<span class="kwrd">&lt;</span><span class="html">p</span><span class="kwrd">&gt;</span>Enter your favorite programming frameworks:<span class="kwrd">&lt;/</span><span class="html">p</span><span class="kwrd">&gt;</span>

<span class="kwrd">&lt;</span><span class="html">form</span> <span class="attr">action</span><span class="kwrd">="${Url.For({@action:'EnterDataResults'})}"</span> <span class="attr">method</span><span class="kwrd">="post"</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;</span><span class="html">input</span> <span class="attr">type</span><span class="kwrd">="hidden"</span> <span class="attr">name</span><span class="kwrd">="user"</span> <span class="attr">value</span><span class="kwrd">="${user.Id}"</span> <span class="kwrd">/&gt;</span>
    <span class="kwrd">&lt;</span><span class="html">table</span> <span class="attr">class</span><span class="kwrd">="blind"</span><span class="kwrd">&gt;</span>
        <span class="kwrd">&lt;</span><span class="html">tr</span><span class="kwrd">&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">td</span><span class="kwrd">&gt;</span>IoC-Framework<span class="kwrd">&lt;/</span><span class="html">td</span><span class="kwrd">&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">td</span><span class="kwrd">&gt;</span>${Form.TextFieldAutoComplete("preference.ioc", Url.For({@action: "LookupIoc"}), inputOpt, ajaxOpt)}<span class="kwrd">&lt;/</span><span class="html">td</span><span class="kwrd">&gt;</span>
        <span class="kwrd">&lt;/</span><span class="html">tr</span><span class="kwrd">&gt;</span>
        <span class="kwrd">&lt;</span><span class="html">tr</span><span class="kwrd">&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">td</span><span class="kwrd">&gt;</span>OR/M-Framework<span class="kwrd">&lt;/</span><span class="html">td</span><span class="kwrd">&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">td</span><span class="kwrd">&gt;</span>${Form.TextFieldAutoComplete("preference.orm", Url.For({@action: "LookupOrm"}), inputOpt, ajaxOpt)}<span class="kwrd">&lt;/</span><span class="html">td</span><span class="kwrd">&gt;</span>
        <span class="kwrd">&lt;/</span><span class="html">tr</span><span class="kwrd">&gt;</span>
        <span class="kwrd">&lt;</span><span class="html">tr</span><span class="kwrd">&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">td</span><span class="kwrd">&gt;&lt;/</span><span class="html">td</span><span class="kwrd">&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">td</span><span class="kwrd">&gt;&lt;</span><span class="html">input</span> <span class="attr">type</span><span class="kwrd">="submit"</span> <span class="attr">value</span><span class="kwrd">="Save Data"</span> <span class="kwrd">/&gt;&lt;/</span><span class="html">td</span><span class="kwrd">&gt;</span>
        <span class="kwrd">&lt;/</span><span class="html">tr</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;/</span><span class="html">table</span><span class="kwrd">&gt;</span>    
<span class="kwrd">&lt;/</span><span class="html">form</span><span class="kwrd">&gt;</span>
</pre>
  </div>
</div>
	<div class="tabBox" id="tabcontent1-2">
<div class="tabBoxGutter">
    <pre class="csharpcode">

#set ($ajaxOpt = "%{parameters='{user:\'$user.Id\'}', paramName='\'search\''}")
#set ($inputOpt = "%{class='txt'}")
<span class="kwrd">&lt;</span><span class="html">p</span><span class="kwrd">&gt;</span>Enter your favorite programming frameworks:<span class="kwrd">&lt;/</span><span class="html">p</span><span class="kwrd">&gt;</span>

<span class="kwrd">&lt;</span><span class="html">form</span> <span class="attr">action</span><span class="kwrd">="$UrlHelper.For("</span>%{<span class="attr">action</span><span class="kwrd">='EnterDataResults'</span>}<span class="kwrd">")"</span> <span class="attr">method</span><span class="kwrd">="post"</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;</span><span class="html">input</span> <span class="attr">type</span><span class="kwrd">="hidden"</span> <span class="attr">name</span><span class="kwrd">="user"</span> <span class="attr">value</span><span class="kwrd">="$user.Id"</span> <span class="kwrd">/&gt;</span>
    <span class="kwrd">&lt;</span><span class="html">table</span> <span class="attr">class</span><span class="kwrd">="blind"</span><span class="kwrd">&gt;</span>
        <span class="kwrd">&lt;</span><span class="html">tr</span><span class="kwrd">&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">td</span><span class="kwrd">&gt;</span>IoC-Framework<span class="kwrd">&lt;/</span><span class="html">td</span><span class="kwrd">&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">td</span><span class="kwrd">&gt;</span>$FormHelper.TextFieldAutoComplete("preference.ioc", UrlHelper.For("%{action='LookupIoc'}"), inputOpt, ajaxOpt)<span class="kwrd">&lt;/</span><span class="html">td</span><span class="kwrd">&gt;</span>
        <span class="kwrd">&lt;/</span><span class="html">tr</span><span class="kwrd">&gt;</span>
        <span class="kwrd">&lt;</span><span class="html">tr</span><span class="kwrd">&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">td</span><span class="kwrd">&gt;</span>OR/M-Framework<span class="kwrd">&lt;/</span><span class="html">td</span><span class="kwrd">&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">td</span><span class="kwrd">&gt;</span>$FormHelper.TextFieldAutoComplete("preference.orm", Url.ForHelper("%{action='LookupOrm'}"), inputOpt, ajaxOpt)<span class="kwrd">&lt;/</span><span class="html">td</span><span class="kwrd">&gt;</span>
        <span class="kwrd">&lt;/</span><span class="html">tr</span><span class="kwrd">&gt;</span>
        <span class="kwrd">&lt;</span><span class="html">tr</span><span class="kwrd">&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">td</span><span class="kwrd">&gt;&lt;/</span><span class="html">td</span><span class="kwrd">&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">td</span><span class="kwrd">&gt;&lt;</span><span class="html">input</span> <span class="attr">type</span><span class="kwrd">="submit"</span> <span class="attr">value</span><span class="kwrd">="Save Data"</span> <span class="kwrd">/&gt;&lt;/</span><span class="html">td</span><span class="kwrd">&gt;</span>
        <span class="kwrd">&lt;/</span><span class="html">tr</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;/</span><span class="html">table</span><span class="kwrd">&gt;</span>    
<span class="kwrd">&lt;/</span><span class="html">form</span><span class="kwrd">&gt;</span>
</pre>
  </div>
</div>
</div>
<script type="text/javascript">
 //<![CDATA[
 
 // Declare a new instance of the TAB class
 var tabcontent1Tab = new TAB();
 
 tabcontent1Tab.name         = "tabcontent1";
 tabcontent1Tab.tabSpacerID  = "tabcontent1_spacer";
 tabcontent1Tab.tabOptionsID = "tabcontent1_options";
 tabcontent1Tab.tabRootID    = "tabcontent1_tabs";
 
 // IDs of the tabs themselves
 tabcontent1Tab.tabIDs[0] = "tabtabcontent1_1";
 tabcontent1Tab.tabIDs[1] = "tabtabcontent1_2";
 
 // IDs of the tab boxes
 tabcontent1Tab.boxIDs[0] = "tabcontent1-1";
 tabcontent1Tab.boxIDs[1] = "tabcontent1-2";
 
 // Initialize the tabs
 tabcontent1Tab.initialize();
 
 // ]]>
</script>

<p>
	Now to the explanation.
	</p><p>
		The variable <tt>ajaxOpt</tt> shows how to specify options for the Scriptaculous AutoCompleter.
		The AutoCompleter wants <tt>JSON</tt>, so you need to make sure that string literals are enclosed
		in quotation marks both in Brail/NVelocity and in the value itself.
	</p><p>
	In this example, the completion options are used to add a custom parameter to the query, which will be
	used by the controller called by the AutoCompleter. Additionally the name of the parameter is 
	changed. If it is left unchanged, AutoCompleter would use the name attribute of the input element,
	in this case <tt>preference.ioc</tt> or <tt>preference.orm</tt>, which is normally unwanted due to
	databinding that should not occur at this point.
	</p><p><tt>inputOpt</tt> simply defines options for the input tag and should be straightforward.</p><p>
	The last thing to do on the calling page is to call the helper method.
	</p><p>Next is the AJAX controller:</p>  <div class="tabWrapper" id="tabcontent2">
<ul class="tabbedNavOff" id="tabcontent2_tabs">
	<li><a class="" id="tabtabcontent2_1" href="#tabcontent2-1" onclick="return tabcontent2Tab.switchTab(this.id,false)"><span><span>Controller</span></span></a></li>
	<li><a class="" id="tabtabcontent2_2" href="#tabcontent2-2" onclick="return tabcontent2Tab.switchTab(this.id,false)"><span><span>Template(Brail)</span></span></a></li>
	<li><a class="" id="tabtabcontent2_3" href="#tabcontent2-3" onclick="return tabcontent2Tab.switchTab(this.id,false)"><span><span>Template(NVelocity)</span></span></a></li>
</ul>
<div class="tabSpacerOff" id="tabcontent2_spacer">&nbsp;</div>
	<div class="tabBox" id="tabcontent2-1">
<div class="tabBoxGutter">
    <pre class="csharpcode">

<span class="kwrd">public</span> <span class="kwrd">void</span> LookupIoc([ARFetch(<span class="str">"user"</span>)]User user, <span class="kwrd">string</span> search)
{
    <span class="rem">// perform search and put results into PropertyBag</span>
}

</pre>
  </div>
</div>
	<div class="tabBox" id="tabcontent2-2">
<div class="tabBoxGutter">
    <pre class="csharpcode">

<span class="kwrd">&lt;</span><span class="html">ul</span><span class="kwrd">&gt;</span>
<span class="asp">&lt;%</span> <span class="kwrd">for</span> ioc <span class="kwrd">in</span> frameworks: <span class="asp">%&gt;</span>
    <span class="kwrd">&lt;</span><span class="html">li</span><span class="kwrd">&gt;</span>${ioc.Name}<span class="kwrd">&lt;/</span><span class="html">li</span><span class="kwrd">&gt;</span>
<span class="asp">&lt;%</span> end <span class="asp">%&gt;</span>
<span class="kwrd">&lt;/</span><span class="html">ul</span><span class="kwrd">&gt;</span>
</pre>
  </div>
</div>
	<div class="tabBox" id="tabcontent2-3">
<div class="tabBoxGutter">
    <pre class="csharpcode">

<span class="kwrd">&lt;</span><span class="html">ul</span><span class="kwrd">&gt;</span>
#foreach ($ioc in $frameworks)
    <span class="kwrd">&lt;</span><span class="html">li</span><span class="kwrd">&gt;</span>$ioc.Name<span class="kwrd">&lt;/</span><span class="html">li</span><span class="kwrd">&gt;</span>
#end
<span class="kwrd">&lt;/</span><span class="html">ul</span><span class="kwrd">&gt;</span>
</pre>
  </div>
</div>
</div>
<script type="text/javascript">
 //<![CDATA[
 
 // Declare a new instance of the TAB class
 var tabcontent2Tab = new TAB();
 
 tabcontent2Tab.name         = "tabcontent2";
 tabcontent2Tab.tabSpacerID  = "tabcontent2_spacer";
 tabcontent2Tab.tabOptionsID = "tabcontent2_options";
 tabcontent2Tab.tabRootID    = "tabcontent2_tabs";
 
 // IDs of the tabs themselves
 tabcontent2Tab.tabIDs[0] = "tabtabcontent2_1";
 tabcontent2Tab.tabIDs[1] = "tabtabcontent2_2";
 tabcontent2Tab.tabIDs[2] = "tabtabcontent2_3";
 
 // IDs of the tab boxes
 tabcontent2Tab.boxIDs[0] = "tabcontent2-1";
 tabcontent2Tab.boxIDs[1] = "tabcontent2-2";
 tabcontent2Tab.boxIDs[2] = "tabcontent2-3";
 
 // Initialize the tabs
 tabcontent2Tab.initialize();
 
 // ]]>
</script>

<p>
	This is straight-forward. Format the results as an unordered list. The AutoCompleter uses this list to
	build the contents of the completion widget.
	</p>		<!-- end content -->
		
	<div id="footer">
<script type="text/javascript"><!--
google_ad_client = "pub-2091974950947714";
/* 728x90, created 2/13/08 */
google_ad_slot = "5378217716";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
	
	<br/>
	Found an error? Something inaccurate? 
	<a href="../../../../../community/getinvolved.html">Help us improve the documentation</a> <br/>
	Generated by <a href="../../../../../others/anakia/index.html">Castle Anakia</a>. 
	
	<p>&nbsp;</p>
	
	<p>
	Sponsored by <img src="../../../../../images/logothumb.gif" /> <a href="http://www.castlestronghold.com">Castle Stronghold</a>.
	</p>
	
	</div>

	<!-- Search Google -->
<center>
<FORM method=GET action="http://www.google.com/custom">
<TABLE bgcolor="#FFFFFF" cellspacing="4" border="0" style="border: solid 1px gray;" align="center">
<tr valign=top><td>
<A HREF="http://www.google.com/search">
<IMG SRC="http://www.google.com/logos/Logo_40wht.gif" border=0 ALT=Google align=middle></A>
</td>
<td>
<INPUT TYPE=text name=q size=31 maxlength=255 value="">
<INPUT type=submit name=sa VALUE="Google Search">
<INPUT type=hidden name=cof VALUE="S:http://www.castlestronghold.com;GL:1;VLC:#373737;AH:center;LH:63;LC:#0A50A1;GFNT:#5B5B5B;L:http://www.castleproject.org/images/castle-logo.gif;ALC:#0A50A1;BIMG:http://www.castleproject.org/images/bg.png;LW:280;T:#5B5B5B;AWFID:3d565acacdd9f388;">
<input type=hidden name=domains value="castleproject.org"><br><input type=radio name=sitesearch value=""> Search WWW <input type=radio name=sitesearch value="castleproject.org" checked> Search castleproject.org
</td></tr></TABLE>
</FORM>
<!-- Search Google -->
</center>
	&nbsp;
	<br/>

		</div> <!-- end of content -->
  </div><!-- end of page -->
  


	<script type="text/javascript">_uacct = "UA-1190612-1";urchinTracker();</script>
	</body>
</html>
