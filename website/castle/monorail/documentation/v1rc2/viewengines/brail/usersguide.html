<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">









<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
		<title>User's Guide :: Castle Project</title>
		<link rel="stylesheet" href="../../../../../base.css" />
		<link rel="stylesheet" href="../../../../../front.css" />
		<link rel="stylesheet" href="../../../../../elem.css" />
		<link rel="stylesheet" href="../../../../../csharp.css" />
		<link rel="stylesheet" href="../../../../../TAB_styles.css" />
		<script type="text/javascript" src="../../../../../mktree.js"></script>
		<script type="text/javascript" src="../../../../../TAB_Function_Lib.js"></script>
		<script src="http://www.google-analytics.com/urchin.js" type="text/javascript"></script>
	</head>

	<body>
<div id="topheader">
  <div id="maintitle">
	<h1> <a href="../../../../../index.html" title="Castle Project Home" accesskey="1">Home</a> </h1>
	<h2> <a href="http://www.castlestronghold.com" title="Castle Stronghold: support, consulting and development">Castle Stronghold</a> </h2>
  </div>
  <div id="mainbar">
	<ul id="toplinks">
		<li>&nbsp;</li>
		<li><a style="_width: 70px;" href="../../../../../index.html">Home</a></li>
		<li><a style="_width: 70px;" href="../../../../../castle/download.html">Download</a></li>
		<li><a style="_width: 110px;" href="http://api.castleproject.org">API Doc</a></li>
		<li><a style="_width: 50px;" href="http://using.castleproject.org">Using</a></li>
		<li><a style="_width: 60px;" href="../../../../../community/forum.html">Forum</a></li>
		<li><a style="_width: 120px;" href="../../../../../issuetracker.html">Issue Tracker</a></li>
		<li><a style="_width: 110px;" href="http://builds.castleproject.org">Builds</a></li>
	</ul>
  </div>
</div>



<div id="coolpage">

	<div id="sidebar" >
		
  <div class="lightmenu">
    <div class="lightmenucontent">
<span class="menutitle">
<a href="./../../../../../monorail/index.html">MonoRail</a>
</span>
  <ul>
<li>
<a href="./../../../../../monorail/gettingstarted/index.html">Getting started</a>
</li>
<li>
<a href="./../../../../../monorail/faq.html">FAQ</a>
</li>
<li>
<a href="./../../../../../monorail/recipes/index.html">Recipes</a>
</li>
<li>
<a href="./../../../../../monorail/externalarticles.html">External Articles</a>
</li>
  </ul>
    </div>
  </div>
  <br/>
  <div class="lightmenu">
    <div class="lightmenucontent">
<span class="menutitle">
<a href="./../../../../../monorail/documentation/v1rc2/index.html">Documentation</a>
</span>
  <ul>
<li>
<a href="./../../../../../monorail/documentation/v1rc2/releasenotes/index.html">Release notes</a>
</li>
<li>
<a href="./../../../../../monorail/documentation/v1rc2/manual/index.html">Reference Manual</a>
</li>
<li>
<a href="./../../../../../monorail/documentation/v1rc2/usersguide/index.html">User's Guide</a>
</li>
<li>
<a href="./../../../../../monorail/documentation/v1rc2/advanced/index.html">Advanced usage</a>
</li>
  </ul>
    </div>
  </div>
  <br/>
  <div class="darkmenu">
    <div class="darkmenucontent">
<span class="menutitle">
Navigation
</span>
  <ul>
<li>
<a href="./../../../../../index.html">Back to Main Page</a>
</li>
  </ul>
    </div>
  </div>
  <br/>
	<br/>
	
	</div>
		
	<div id="content">
	
		<div class="callout-pic">

<!-- Begin Table of contents -->
<div id="toc">
<h2>Table of contents</h2>
<ul>
<li class='toclevel-1'><a href="#completeexample"><span class="tocnumber">1</span> <span class="toctext">A complete example</span></a>
</li>
<li class='toclevel-1'><a href="#Outputmethods"><span class="tocnumber">2</span> <span class="toctext">Output methods</span></a>
</li>
<li class='toclevel-1'><a href="#Usingvariables"><span class="tocnumber">3</span> <span class="toctext">Using variables</span></a>
</li>
<li class='toclevel-1'><a href="#subviews"><span class="tocnumber">4</span> <span class="toctext">Using sub views</span></a>
</li>
<li class='toclevel-1'><a href="#includingfiles"><span class="tocnumber">5</span> <span class="toctext">Including files</span></a>
</li>
<li class='toclevel-1'><a href="#"><span class="tocnumber">6</span> <span class="toctext">Principle of Least Surprise</span></a>
</li>
<li class='toclevel-1'><a href="#CommonFunctionality"><span class="tocnumber">7</span> <span class="toctext">Common Functionality</span></a>
</li>
<li class='toclevel-1'><a href="#layouts"><span class="tocnumber">8</span> <span class="toctext">Layouts</span></a>
</li>
</ul>
</div>
<!-- End Table of contents -->
		</div>

		<h1 class="firstHeading">
		    User's Guide
		</h1> 
	
<div class="breadcrumbs">
&raquo;
	<a href="./../../../../../index.html">Home</a> 
&raquo;
	<a href="./../../../../../monorail/index.html">MonoRail</a> 
&raquo;
	<a href="./../../../../../monorail/documentation/index.html">Documentation</a> 
&raquo;
	<a href="./../../../../../monorail/documentation/v1rc2/index.html">MonoRail RC2 Documentation</a> 
&raquo;
	<a href="./../../../../../monorail/documentation/v1rc2/viewengines/index.html">View Engines</a> 
&raquo;
	<a href="./../../../../../monorail/documentation/v1rc2/viewengines/brail/index.html">Brail View Engine</a> 
&raquo;
<u>User's Guide</u>
</div>

		<!-- start content -->
<a name="completeexample"></a>
  <h1>A complete example</h1>
    <pre class="csharpcode">

<span class="kwrd">&lt;</span><span class="html">html</span><span class="kwrd">&gt;</span>    
<span class="kwrd">&lt;</span><span class="html">head</span><span class="kwrd">&gt;</span>        
<span class="kwrd">&lt;</span><span class="html">title</span><span class="kwrd">&gt;</span>${title}<span class="kwrd">&lt;/</span><span class="html">title</span><span class="kwrd">&gt;</span>
<span class="kwrd">&lt;/</span><span class="html">head</span><span class="kwrd">&gt;</span>    
<span class="kwrd">&lt;</span><span class="html">body</span><span class="kwrd">&gt;</span>        
     <span class="kwrd">&lt;</span><span class="html">p</span><span class="kwrd">&gt;</span>The following items are in the list:<span class="kwrd">&lt;/</span><span class="html">p</span><span class="kwrd">&gt;</span>  
     <span class="kwrd">&lt;</span><span class="html">ul</span><span class="kwrd">&gt;</span><span class="asp">&lt;%</span><span class="kwrd">for</span> element <span class="kwrd">in</span> list:    output <span class="str">"&lt;li&gt;${element}&lt;/li&gt;"</span><span class="asp">%&gt;</span><span class="kwrd">&lt;/</span><span class="html">ul</span><span class="kwrd">&gt;</span>
     <span class="kwrd">&lt;</span><span class="html">p</span><span class="kwrd">&gt;</span>I hope that you would like Brail<span class="kwrd">&lt;/</span><span class="html">p</span><span class="kwrd">&gt;</span>    
<span class="kwrd">&lt;/</span><span class="html">body</span><span class="kwrd">&gt;</span>
<span class="kwrd">&lt;/</span><span class="html">html</span><span class="kwrd">&gt;</span></pre>
  <p>The output of this program (assuming list is (1,2,3) and title is "Demo" ) 
would be:</p>    <pre class="csharpcode">

<span class="kwrd">&lt;</span><span class="html">html</span><span class="kwrd">&gt;</span>   
<span class="kwrd">&lt;</span><span class="html">head</span><span class="kwrd">&gt;</span>        
<span class="kwrd">&lt;</span><span class="html">title</span><span class="kwrd">&gt;</span>Demo<span class="kwrd">&lt;/</span><span class="html">title</span><span class="kwrd">&gt;</span>   
<span class="kwrd">&lt;/</span><span class="html">head</span><span class="kwrd">&gt;</span>    
<span class="kwrd">&lt;</span><span class="html">body</span><span class="kwrd">&gt;</span>        
     <span class="kwrd">&lt;</span><span class="html">p</span><span class="kwrd">&gt;</span>The following items are in the list:<span class="kwrd">&lt;/</span><span class="html">p</span><span class="kwrd">&gt;</span> 
     <span class="kwrd">&lt;</span><span class="html">ul</span><span class="kwrd">&gt;&lt;</span><span class="html">li</span><span class="kwrd">&gt;</span>1<span class="kwrd">&lt;/</span><span class="html">li</span><span class="kwrd">&gt;&lt;</span><span class="html">li</span><span class="kwrd">&gt;</span>2<span class="kwrd">&lt;/</span><span class="html">li</span><span class="kwrd">&gt;&lt;</span><span class="html">li</span><span class="kwrd">&gt;</span>3<span class="kwrd">&lt;/</span><span class="html">li</span><span class="kwrd">&gt;&lt;/</span><span class="html">ul</span><span class="kwrd">&gt;</span>
<span class="kwrd">&lt;/</span><span class="html">body</span><span class="kwrd">&gt;</span>
<span class="kwrd">&lt;/</span><span class="html">html</span><span class="kwrd">&gt;</span></pre>
  <p>And the rendered HTML will look like this:</p>    <pre class="csharpcode">

----
The following items are in the list:    
* 1
* 2
* 3
-----</pre>
  <a name="Outputmethods"></a>
  <h1>Output methods</h1>
<p>Since most of the time you will want to slice and dice text to serve the client, you need some special tools to aid you in doing this. Output methods* are methods that are decorated by [Html] / [Raw] / [MarkDown] attributes. An output method return value is transformed according to the specified attribute that has been set on it, for instance, consider the [Html] attribute:
</p>    <pre class="csharpcode">

<span class="asp">&lt;%</span>
[Html]
def HtmlMethod():
    <span class="kwrd">return</span> <span class="str">"Some text that will be &lt;html&gt; encoded"</span>
end
<span class="asp">%&gt;</span>
${HtmlMethod()}</pre>
  <p>
The output of the above script would be:
</p>  <pre class="commonpre">Some text that will be &amp;lt;html&amp;gt; encoded</pre>
<p>The output of a method with [Raw] attribute is the same as it would've without it (it's supplied as a NullObject for the common case) but the output of the MarkDown attribute is pretty interesting. Here is the code:</p>    <pre class="csharpcode">

<span class="asp">&lt;%</span>
[MarkDown]
def MarkDownOutput():
    <span class="kwrd">return</span> <span class="str">"[Ayende Rahien](http://www.ayende.com/), __Rahien__."</span>
end
<span class="asp">%&gt;</span>
${MarkDownOutput()}
</pre>
  <p>And here is the output:
</p>    <pre class="csharpcode">

<span class="kwrd">&lt;</span><span class="html">p</span><span class="kwrd">&gt;&lt;</span><span class="html">a</span> <span class="attr">href</span><span class="kwrd">="http://www.ayende.com/"</span><span class="kwrd">&gt;</span>Ayende Rahien<span class="kwrd">&lt;/</span><span class="html">a</span><span class="kwrd">&gt;</span>, <span class="kwrd">&lt;</span><span class="html">strong</span><span class="kwrd">&gt;</span>Rahien<span class="kwrd">&lt;/</span><span class="html">strong</span><span class="kwrd">&gt;</span>.<span class="kwrd">&lt;/</span><span class="html">p</span><span class="kwrd">&gt;</span></pre>
  <p>[http://daringfireball.net/projects/markdown/ Markdown] is very interesting and I suggest you read about its usage.</p><a name="Usingvariables"></a>
  <h1>Using variables</h1>
<p>A controller can send the view variables, and the [http://boo.codehaus.org Boo] script can reference them very easily:</p>    <pre class="csharpcode">

My name is ${name}
<span class="kwrd">&lt;</span><span class="html">ul</span><span class="kwrd">&gt;</span>
<span class="asp">&lt;%</span>
<span class="kwrd">for</span> element <span class="kwrd">in</span> list:
    output <span class="str">"&lt;li&gt;${element}&lt;/li&gt;"</span>
end
<span class="asp">%&gt;</span>
<span class="kwrd">&lt;/</span><span class="html">ul</span><span class="kwrd">&gt;</span>
</pre>
  <p>Brail has all the normal control statements of [http://boo.codehaus.org Boo], which allows for very easy way to handle such things as:</p>    <pre class="csharpcode">

<span class="asp">&lt;%</span> output AdminMenu(user) <span class="kwrd">if</span> user.IsAdministrator <span class="asp">%&gt;</span>
</pre>
  <p>
This will send the menu to the user only if he is administrator.
</p><p>
One thing to note about these var/onethignail is taking the variable and trying to find a matching variable in the property bag that the controller is passing. If the variable does not exist, this will cause an error, so pay attention to that. You can test that a variable exists by calling the IsDefined() method. 
</p>    <pre class="csharpcode">

<span class="asp">&lt;%</span>
<span class="kwrd">if</span> IsDefined(<span class="str">"error"</span>):
    output error
end
<span class="asp">%&gt;</span>
</pre>
  <a name="subviews"></a>
  <h1>Using sub views</h1>
<p>
There are many reasons that you may want to use a sub view in your views and 
there are several ways to do that in Brail. The first one is to simply use the 
common functionality. This gives a good solution in most cases (see below for a 
more detailed discussion of common scripts).
</p><p>
The other ways is to use a true sub view, in Brail, you do that using the 
OutputSubView() method:
</p>    <pre class="csharpcode">

Some html
<span class="kwrd">&lt;?</span><span class="html">brail</span> <span class="attr">OutputSubView</span>(&<span class="attr">amp</span>;<span class="attr">quot</span>;/<span class="attr">home</span>/<span class="attr">menu</span>&<span class="attr">amp</span>;<span class="attr">quot</span>;) ?<span class="kwrd">&gt;</span>
<span class="kwrd">&lt;</span><span class="html">br</span><span class="kwrd">/&gt;</span>some more html 
</pre>
  <p>
You need to pay attention to two things here:
</p><p>
The rules for finding the sub view are as followed:
</p><p>
* If the sub view start with a '/' : then the sub view is found using the same algorithm you use for RenderView()
* If the sub view doesn't start with a '/' : the sub view is searched starting from the ''current script'' directory.
</p><p>
A sub view inherit all the properties from its parent view, so you have access to anything that you want there.
</p><p>
You can also call a sub view with parameters, like you would call a function, you do it like this:
</p>    <pre class="csharpcode">
</pre>
  <p>
Pay attention to the brackets, what we have here is a dictionary that is passed to the /home/menu view. From the sub view itself, you can just access the variables normally. This variables, however, are not inherited from views to sub views.
</p><a name="includingfiles"></a>
  <h1>Including files</h1>
<p>
	Occasionally a need will arise to include a file "as-is" in the output, this may be a script file, or a common html code, and the point is not to interpret it, but simply send it to the user. In order to do that, you simply need to do this:
</p>    <pre class="csharpcode">

 ${System.IO.File.OpenText("some-file.js").ReadToEnd()}
</pre>
  <p>
Of course, this is quite a bit to write, so you can just put an import at the top of the file and then call the method without the namespace:
</p>    <pre class="csharpcode">

<span class="asp">&lt;%</span>
import System.IO
<span class="asp">%&gt;</span>
${File.OpenText("some-file.js").ReadToEnd()}
</pre>
    <h1>Principle of Least Surprise</h1>
<p>
	On general, since NVelocity is more or less the "official" view engine for 
now, I tried to copy as much behavior as possible from NVelocityViewEngine. If 
you've a question about how Brail works, you can usually rely on the 
NVelocity behavior. If you find something different, that is probably a bug, so 
tell me about it.
</p><a name="CommonFunctionality"></a>
  <h1>Common Functionality</h1>
<p>
In many cases, you'll have common functionality that you'll want to share among all views. Just drop the file in the CommonScripts directory - (most often, this means that you will drop your common functionality to Views\CommonScripts) - and they will be accessible to any script under the site.
</p>  <div class="note">
<div class="notetopbg">
<div class="noteborderleft">
<div class="noteborderright">
<div class="notetopleft">
<div class="notetopright">
<div class="notebottomleft">
<div class="notebottomright">
<div class="boxtitle">Quick Note</div>
<div class="innercontent">
<p>
The language used to write the common scripts is the __white space agnostic__ deriative of Boo, and not the normal one. This is done so you woulnd't have white spacing sensitivity in one place and not in the other.
</p>
</div></div></div></div></div></div></div></div></div>
  <div class="note">
<div class="notetopbg">
<div class="noteborderleft">
<div class="noteborderright">
<div class="notetopleft">
<div class="notetopright">
<div class="notebottomleft">
<div class="notebottomright">
<div class="boxtitle">Quick Note</div>
<div class="innercontent">
<p>
The common scripts are normal Boo scripts and gets none of the special treatment that the view scripts gets.
An error in compiling one of the common scripts would cause the entire application to stop. An error in compiling one of the common scripts would cause the '''entire''' application to stop.
</p>
</div></div></div></div></div></div></div></div></div>
<p>
Here is an example of a script that sits on the CommonScripts and how to access it from a view:
</p><p><tt>Views\CommonScripts\SayHello.boo</tt> - The common script
</p>    <pre class="csharpcode">

 def SayHello(name <span class="kwrd">as</span> <span class="kwrd">string</span>):
          <span class="kwrd">return</span> <span class="str">"Hello, ${name}"</span>
 end
</pre>
  <p><tt>Views\Home\HelloFromCommon.boo</tt> - The view using the common functionality
</p>    <pre class="csharpcode">

 <span class="asp">&lt;%</span>
 output SayHello(<span class="str">"Ayende"</span>)
 <span class="asp">%&gt;</span>
</pre>
  <p>
 The output from the script:
</p>    <pre class="csharpcode">

Hello, Ayende
</pre>
  <a name="layouts"></a>
  <h1>Layouts</h1>
<p>
Using layouts is very easy, it is just a normal script that outputs ChildOutput property somewhere, here is an example:
</p>    <pre class="csharpcode">

Header
${ChildOutput}
Footer
</pre>
  		<!-- end content -->
		
	<div id="footer">
<script type="text/javascript"><!--
google_ad_client = "pub-2091974950947714";
/* 728x90, created 2/13/08 */
google_ad_slot = "5378217716";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
	
	<br/>
	Found an error? Something inaccurate? 
	<a href="../../../../../community/getinvolved.html">Help us improve the documentation</a> <br/>
	Generated by <a href="../../../../../others/anakia/index.html">Castle Anakia</a>. 
	
	<p>&nbsp;</p>
	
	<p>
	Sponsored by <img src="../../../../../images/logothumb.gif" /> <a href="http://www.castlestronghold.com">Castle Stronghold</a>.
	</p>
	
	</div>

	<!-- Search Google -->
<center>
<FORM method=GET action="http://www.google.com/custom">
<TABLE bgcolor="#FFFFFF" cellspacing="4" border="0" style="border: solid 1px gray;" align="center">
<tr valign=top><td>
<A HREF="http://www.google.com/search">
<IMG SRC="http://www.google.com/logos/Logo_40wht.gif" border=0 ALT=Google align=middle></A>
</td>
<td>
<INPUT TYPE=text name=q size=31 maxlength=255 value="">
<INPUT type=submit name=sa VALUE="Google Search">
<INPUT type=hidden name=cof VALUE="S:http://www.castlestronghold.com;GL:1;VLC:#373737;AH:center;LH:63;LC:#0A50A1;GFNT:#5B5B5B;L:http://www.castleproject.org/images/castle-logo.gif;ALC:#0A50A1;BIMG:http://www.castleproject.org/images/bg.png;LW:280;T:#5B5B5B;AWFID:3d565acacdd9f388;">
<input type=hidden name=domains value="castleproject.org"><br><input type=radio name=sitesearch value=""> Search WWW <input type=radio name=sitesearch value="castleproject.org" checked> Search castleproject.org
</td></tr></TABLE>
</FORM>
<!-- Search Google -->
</center>
	&nbsp;
	<br/>

		</div> <!-- end of content -->
  </div><!-- end of page -->
  


	<script type="text/javascript">_uacct = "UA-1190612-1";urchinTracker();</script>
	</body>
</html>
