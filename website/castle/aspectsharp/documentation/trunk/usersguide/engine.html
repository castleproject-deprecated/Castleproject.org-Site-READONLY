<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">









<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
		<title>Aspect Engine :: Castle Project</title>
		<link rel="stylesheet" href="../../../../base.css" />
		<link rel="stylesheet" href="../../../../front.css" />
		<link rel="stylesheet" href="../../../../elem.css" />
		<link rel="stylesheet" href="../../../../csharp.css" />
		<link rel="stylesheet" href="../../../../TAB_styles.css" />
		<script type="text/javascript" src="../../../../mktree.js"></script>
		<script type="text/javascript" src="../../../../TAB_Function_Lib.js"></script>
		<script src="http://www.google-analytics.com/urchin.js" type="text/javascript"></script>
	</head>

	<body>
<div id="topheader">
  <div id="maintitle">
	<h1> <a href="../../../../index.html" title="Castle Project Home" accesskey="1">Home</a> </h1>
	<h2> <a href="http://www.castlestronghold.com" title="Castle Stronghold: support, consulting and development">Castle Stronghold</a> </h2>
  </div>
  <div id="mainbar">
	<ul id="toplinks">
		<li>&nbsp;</li>
		<li><a style="_width: 70px;" href="../../../../index.html">Home</a></li>
		<li><a style="_width: 70px;" href="../../../../castle/download.html">Download</a></li>
		<li><a style="_width: 110px;" href="http://api.castleproject.org">API Doc</a></li>
		<li><a style="_width: 50px;" href="http://using.castleproject.org">Using</a></li>
		<li><a style="_width: 60px;" href="../../../../community/forum.html">Forum</a></li>
		<li><a style="_width: 120px;" href="../../../../jira.html">Jira/Issue tracker</a></li>
		<li><a style="_width: 110px;" href="http://builds.castleproject.org">Builds</a></li>
	</ul>
  </div>
</div>



<div id="coolpage">

	<div id="sidebar" >
		
  <div class="lightmenu">
    <div class="lightmenucontent">
<span class="menutitle">
<a href="./../../../../aspectsharp/index.html">Aspect#</a>
</span>
  <ul>
<li>
<a href="./../../../../aspectsharp/gettingstarted/index.html">Getting started</a>
</li>
<li>
<a href="./../../../../aspectsharp/faq.html">FAQ</a>
</li>
<li>
<a href="./../../../../aspectsharp/recipes/index.html">Recipes</a>
</li>
<li>
<a href="./../../../../aspectsharp/externalarticles.html">External Articles</a>
</li>
  </ul>
    </div>
  </div>
  <br/>
  <div class="darkmenu">
    <div class="darkmenucontent">
<span class="menutitle">
Navigation
</span>
  <ul>
<li>
<a href="./../../../../aspectsharp/index.html">Back to Aspect#</a>
</li>
<li>
<a href="./../../../../index.html">Back to Main Page</a>
</li>
  </ul>
    </div>
  </div>
  <br/>
	<br/>
	
	</div>
		
	<div id="content">
	
		<div class="callout-pic">

<!-- Begin Table of contents -->
<div id="toc">
<h2>Table of contents</h2>
<ul>
<li class='toclevel-1'><a href="#aspectconfiguration"><span class="tocnumber">1</span> <span class="toctext">The AspectEngine.Wrap method</span></a>
</li>
<li class='toclevel-1'><a href="#aspectconfiguration"><span class="tocnumber">2</span> <span class="toctext">The AspectEngine.WrapInterface method</span></a>
</li>
</ul>
</div>
<!-- End Table of contents -->
		</div>

		<h1 class="firstHeading">
		    Aspect Engine
		</h1> 
	
<div class="breadcrumbs">
&raquo;
	<a href="./../../../../index.html">Home</a> 
&raquo;
	<a href="./../../../../aspectsharp/index.html">Aspect#</a> 
&raquo;
	<a href="./../../../../aspectsharp/documentation/index.html">Documentation</a> 
&raquo;
	<a href="./../../../../aspectsharp/documentation/trunk/index.html">MonoRail RC2 Documentation</a> 
&raquo;
	<a href="./../../../../aspectsharp/documentation/trunk/usersguide/index.html">User's Guide</a> 
&raquo;
<u>Aspect Engine</u>
</div>

		<!-- start content -->
<p>The AspectEngine is the entry point to add AOP capabilities to your classes. Usually there is no point in just constructing an AspectEngine and start using it. You need one of the Builders to proper construct an AspectEngine with a configuration that depicts your intentions. For more information about builder, check the <a href="TODO" >Builder Reference</a>.</p>  <div class="warning">
<div class="warningtopbg">
<div class="warningborderleft">
<div class="warningborderright">
<div class="warningtopleft">
<div class="warningtopright">
<div class="warningbottomleft">
<div class="warningbottomright">
	<div class="boxtitle">Warning</div>
<div class="innercontent">
<p>
This is document is a WORK IN PROGRESS
</p>
</div></div></div></div></div></div></div></div></div>
<a name="aspectconfiguration"></a>
  <h1>The AspectEngine.Wrap method</h1>
<p>Once you have your proper AspectEngine instance, use the Wrap method with a object instance to start all the magic. From now on let's call this instance the invocation target.</p>    <pre class="csharpcode">

 <span class="kwrd">using</span> System.Collections;
 
 AspectEngine engine = <span class="rem">// ...</span>
 IList list = engine.Wrap( <span class="kwrd">new</span> ArrayList() ) <span class="kwrd">as</span> IList;
</pre>
  <p>
Here is what happens in a nutshell:

<ol><li>The engine will extract the inner type of instance</li><li>This inner type is compared with the aspect definitions in the configuration
		<ul><li>If no match is found, the very same instance is returned</li><li>If a match is found, the instance is wrapped with a proxy and the proxy is returned</li></ul></li></ol></p><p>You must note that the instance you've passed in the Wrap's argument is used by the proxy, so now you have a totally different instance to work with. See the caveats section to see it can be a problem for some cases.</p><p>The returned proxy is guaranteed to:
<ul><li>Extend your type</li><li>Override all virtual methods in your type a dispatch to the invocation target</li><li>Implement all mixins interfaces if any</li><li>Create all mixins instances that your aspect declare</li><li>Dispatch invocations to the mixins to the proper mixin instance</li></ul></p><p>Please note that for performance reasons we don't check for collisions in the types implemented. So, if your type exposes a Name property and one of the mixin have this same property on its interface you'll get a really nasty error.</p><p>Your mixins must have a default constructor or the engine won't be able to create the mixins instances.</p><a name="aspectconfiguration"></a>
  <h1>The AspectEngine.WrapInterface method</h1>
<p>This method, available since Alpha 2.0.0.4, allows you to specify the target type to be matched and the invocation target instance.</p>    <pre class="csharpcode">

 <span class="kwrd">using</span> System.Collections;
 
 AspectEngine engine = <span class="rem">// ...</span>
 IList list = engine.WrapInterface( <span class="kwrd">typeof</span>( IList ), <span class="kwrd">new</span> ArrayList() ) <span class="kwrd">as</span> IList;
</pre>
  <p>Despite the fact that you may have the same result, Aspect# will chose a different path when generating the proxy for you. In this case you don't have to be afraid of non-virtual methods not being overrided, thus this is a safer strategy if you're dealing with type that you don't have control.</p><p>Also, if you have an aspect definition for a interface, instead of a concrete type, you may be forced to use the WrapInterface instead.</p>		<!-- end content -->
		
	<div id="footer">
	Found an error? Something inaccurate? 
	<a href="../../../../community/getinvolved.html">Help us improve the documentation</a> <br/>
	Generated by <a href="../../../../others/anakia/index.html">Castle Anakia</a>. 
	
	<p>&nbsp;</p>
	
	<p>
	Sponsored by <img src="../../../../images/logothumb.gif" /> <a href="http://www.castlestronghold.com">Castle Stronghold</a>.
	</p>
	
	</div>

	<!-- Search Google -->
<center>
<FORM method=GET action="http://www.google.com/custom">
<TABLE bgcolor="#FFFFFF" cellspacing="4" border="0" style="border: solid 1px gray;" align="center">
<tr valign=top><td>
<A HREF="http://www.google.com/search">
<IMG SRC="http://www.google.com/logos/Logo_40wht.gif" border=0 ALT=Google align=middle></A>
</td>
<td>
<INPUT TYPE=text name=q size=31 maxlength=255 value="">
<INPUT type=submit name=sa VALUE="Google Search">
<INPUT type=hidden name=cof VALUE="S:http://www.castlestronghold.com;GL:1;VLC:#373737;AH:center;LH:63;LC:#0A50A1;GFNT:#5B5B5B;L:http://www.castleproject.org/images/castle-logo.gif;ALC:#0A50A1;BIMG:http://www.castleproject.org/images/bg.png;LW:280;T:#5B5B5B;AWFID:3d565acacdd9f388;">
<input type=hidden name=domains value="castleproject.org"><br><input type=radio name=sitesearch value=""> Search WWW <input type=radio name=sitesearch value="castleproject.org" checked> Search castleproject.org
</td></tr></TABLE>
</FORM>
<!-- Search Google -->
</center>
	&nbsp;
	<br/>

		</div> <!-- end of content -->
  </div><!-- end of page -->
  


	<script type="text/javascript">_uacct = "UA-1190612-1";urchinTracker();</script>
	</body>
</html>
