<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">









<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
		<title>Schema generation :: Castle Project</title>
		<link rel="stylesheet" href="../../../../base.css" />
		<link rel="stylesheet" href="../../../../front.css" />
		<link rel="stylesheet" href="../../../../elem.css" />
		<link rel="stylesheet" href="../../../../csharp.css" />
		<link rel="stylesheet" href="../../../../TAB_styles.css" />
		<script type="text/javascript" src="../../../../mktree.js"></script>
		<script type="text/javascript" src="../../../../TAB_Function_Lib.js"></script>
		<script src="http://www.google-analytics.com/urchin.js" type="text/javascript"></script>
	</head>

	<body>
<div id="topheader">
  <div id="maintitle">
	<h1> <a href="../../../../index.html" title="Castle Project Home" accesskey="1">Home</a> </h1>
	<h2> <a href="http://www.castlestronghold.com" title="Castle Stronghold: support, consulting and development">Castle Stronghold</a> </h2>
  </div>
  <div id="mainbar">
	<ul id="toplinks">
		<li>&nbsp;</li>
		<li><a style="_width: 70px;" href="../../../../index.html">Home</a></li>
		<li><a style="_width: 70px;" href="../../../../castle/download.html">Download</a></li>
		<li><a style="_width: 50px;" href="http://using.castleproject.org">Using</a></li>
		<li><a style="_width: 60px;" href="../../../../community/forum.html">Forum</a></li>
		<li><a style="_width: 120px;" href="../../../../jira.html">Issue Tracker</a></li>
		<li><a style="_width: 110px;" href="../../../../irc.html">IRC</a></li>
		<li><a style="_width: 110px;" href="http://builds.castleproject.org">Builds</a></li>
	</ul>
  </div>
</div>



<div id="coolpage">

	<div id="sidebar" >
		
  <div class="lightmenu">
    <div class="lightmenucontent">
<span class="menutitle">
<a href="./../../../../activerecord/index.html">ActiveRecord</a>
</span>
  <ul>
<li>
<a href="./../../../../activerecord/gettingstarted/index.html">Getting started</a>
</li>
<li>
<a href="./../../../../activerecord/faq.html">FAQ</a>
</li>
<li>
<a href="./../../../../activerecord/recipes/index.html">Recipes</a>
</li>
<li>
<a href="./../../../../activerecord/externalarticles.html">External Articles</a>
</li>
  </ul>
    </div>
  </div>
  <br/>
  <div class="lightmenu">
    <div class="lightmenucontent">
<span class="menutitle">
<a href="./../../../../activerecord/documentation/trunk/index.html">Documentation</a>
</span>
  <ul>
<li>
<a href="./../../../../activerecord/documentation/trunk/releasenotes/index.html">Release notes</a>
</li>
<li>
<a href="./../../../../activerecord/documentation/trunk/manual/index.html">Reference Manual</a>
</li>
<li>
<a href="./../../../../activerecord/documentation/trunk/usersguide/index.html">User's Guide</a>
</li>
<li>
<a href="./../../../../activerecord/documentation/trunk/advanced/index.html">Advanced usage</a>
</li>
  </ul>
    </div>
  </div>
  <br/>
  <div class="darkmenu">
    <div class="darkmenucontent">
<span class="menutitle">
Navigation
</span>
  <ul>
<li>
<a href="./../../../../index.html">Back to Main Page</a>
</li>
  </ul>
    </div>
  </div>
  <br/>
	<br/>
	
	</div>
		
	<div id="content">
	
		<div class="callout-pic">

<!-- Begin Table of contents -->
<div id="toc">
<h2>Table of contents</h2>
<ul>
<li class='toclevel-1'><a href="#ARSchemaGen"><span class="tocnumber">1</span> <span class="toctext">Allowing ActiveRecord generate the schema</span></a>
</li>
<li class='toclevel-1'><a href="#execscriptfile"><span class="tocnumber">2</span> <span class="toctext">Executing an external script file</span></a>
</li>
</ul>
</div>
<!-- End Table of contents -->
		</div>

		<h1 class="firstHeading">
		    Schema generation
		</h1> 
	
<div class="breadcrumbs">
&raquo;
	<a href="./../../../../index.html">Home</a> 
&raquo;
	<a href="./../../../../activerecord/index.html">ActiveRecord</a> 
&raquo;
	<a href="./../../../../activerecord/documentation/index.html">Documentation</a> 
&raquo;
	<a href="./../../../../activerecord/documentation/trunk/index.html">ActiveRecord trunk Documentation</a> 
&raquo;
	<a href="./../../../../activerecord/documentation/trunk/usersguide/index.html">User's Guide</a> 
&raquo;
<u>Schema generation</u>
</div>

		<!-- start content -->
<p>
Creating the DDL script and keeping it up-to-date with the code is a time consuming task. There are a number
of different ways to do this, and every every developer has their own preferences. Companies tend to work according 
to their own specific standards.
</p><p>
Castle ActiveRecord exposes a NHibernate feature to create and drop schemas. The relevant methods are:
</p><ul><li><tt>CreateSchema</tt> and <tt>DropSchema</tt> will create and drop the schema against the database</li><li><tt>GenerateCreationScripts</tt> and <tt>GenerateDropScripts</tt> generate a file with the scripts</li><li><tt>CreateSchemaFromFile</tt> executes a DDL script against the database</li></ul><p>
All of the above methods are exposed by the <tt>ActiveRecordStarter</tt> class and can only be used after you have invoked 
one of the <a href="configref.html" >Initialize method overloads</a>.
</p><a name="ARSchemaGen"></a>
  <h1>Allowing ActiveRecord generate the schema</h1>
<p>
Allowing ActiveRecord generate and execute the creation schema is desirable in certain scenarios. For example, to prototype an application or to build a test database. 
</p><p>
If you want to use this approach you will need to specify some 
additional properties on your active record attributes. These additional properties, which include <tt>NotNull</tt> and 
<tt>Length</tt>, are used to guide the schema generation. 
For more information see  
<a href="../manual/attributes.html" >Attributes</a> article.
</p>  <div class="warning">
<div class="warningtopbg">
<div class="warningborderleft">
<div class="warningborderright">
<div class="warningtopleft">
<div class="warningtopright">
<div class="warningbottomleft">
<div class="warningbottomright">
	<div class="boxtitle">Warning</div>
<div class="innercontent">
<p>
Be aware that the schema generation is not bullet proof. For some complex models the generated script might be buggy. For 95% of the cases it is acceptable.
</p>
</div></div></div></div></div></div></div></div></div>
<p>
Consider the following <i>ActiveRecord type</i> definition:
</p>    <pre class="csharpcode">

<span class="kwrd">using</span> Castle.ActiveRecord;

[ActiveRecord(<span class="str">"Blogs"</span>)]
<span class="kwrd">public</span> <span class="kwrd">class</span> Blog : ActiveRecordBase
{
    <span class="kwrd">private</span> <span class="kwrd">int</span> id;
    <span class="kwrd">private</span> String name;
    <span class="kwrd">private</span> String author;

    [PrimaryKey(PrimaryKeyType.Native, <span class="str">"blog_id"</span>)]
    <span class="kwrd">public</span> <span class="kwrd">int</span> Id
    {
        get { <span class="kwrd">return</span> id; }
        set { id = <span class="kwrd">value</span>; }
    }

    [Property(<span class="str">"blog_name"</span>, NotNull=<span class="kwrd">true</span>, Length=25)]
    <span class="kwrd">public</span> String Name
    {
        get { <span class="kwrd">return</span> name; }
        set { name = <span class="kwrd">value</span>; }
    }

    [Property(<span class="str">"blog_author"</span>, NotNull=<span class="kwrd">true</span>, Length=50)]
    <span class="kwrd">public</span> String Author
    {
        get { <span class="kwrd">return</span> author; }
        set { author = <span class="kwrd">value</span>; }
    }
}</pre>
  <p>
The following code will initialize the framework and generate the schema:
</p>    <pre class="csharpcode">

ActiveRecordStarter.Initialize(<span class="kwrd">new</span> XmlConfigurationSource(<span class="str">"appconfig.xml"</span>), <span class="kwrd">typeof</span>(Blog));
ActiveRecordStarter.CreateSchema();</pre>
    <div class="note">
<div class="notetopbg">
<div class="noteborderleft">
<div class="noteborderright">
<div class="notetopleft">
<div class="notetopright">
<div class="notebottomleft">
<div class="notebottomright">
<div class="boxtitle">Quick Note</div>
<div class="innercontent">
<p>
The <tt>CreateSchema</tt> method will drop any existing tables with the same name before it creates
new tables. Be very cautious about performing this operation on a production database.
</p>
</div></div></div></div></div></div></div></div></div>
<a name="execscriptfile"></a>
  <h1>Executing an external script file</h1>
<p>
This may be a better alternative, especially if you work on team that has someone dedicated to keep the database schema up to date.
The SQL files can be part of the project and can be executed during initialization.
</p>    <pre class="csharpcode">

ActiveRecordStarter.Initialize(<span class="kwrd">new</span> XmlConfigurationSource(<span class="str">"appconfig.xml"</span>), <span class="kwrd">typeof</span>(Blog) );
ActiveRecordStarter.CreateSchemaFromFile(<span class="str">"myscript1.sql"</span>);
ActiveRecordStarter.CreateSchemaFromFile(<span class="str">"myscript2.sql"</span>);</pre>
  		<!-- end content -->
		
	<div id="footer">
	Found an error? Something inaccurate? 
	<a href="../../../../community/getinvolved.html">Help us improve the documentation</a> <br/>
	Generated by <a href="../../../../others/anakia/index.html">Castle Anakia</a>. 
	
	<p>&nbsp;</p>
	
	<p>
	Sponsored by <img src="../../../../images/logothumb.gif" /> <a href="http://www.castlestronghold.com">Castle Stronghold</a>.
	</p>
	
	</div>

	<!-- Search Google -->
<center>
<FORM method=GET action="http://www.google.com/custom">
<TABLE bgcolor="#FFFFFF" cellspacing="4" border="0" style="border: solid 1px gray;" align="center">
<tr valign=top><td>
<A HREF="http://www.google.com/search">
<IMG SRC="http://www.google.com/logos/Logo_40wht.gif" border=0 ALT=Google align=middle></A>
</td>
<td>
<INPUT TYPE=text name=q size=31 maxlength=255 value="">
<INPUT type=submit name=sa VALUE="Google Search">
<INPUT type=hidden name=cof VALUE="S:http://www.castlestronghold.com;GL:1;VLC:#373737;AH:center;LH:63;LC:#0A50A1;GFNT:#5B5B5B;L:http://www.castleproject.org/images/castle-logo.gif;ALC:#0A50A1;BIMG:http://www.castleproject.org/images/bg.png;LW:280;T:#5B5B5B;AWFID:3d565acacdd9f388;">
<input type=hidden name=domains value="castleproject.org"><br><input type=radio name=sitesearch value=""> Search WWW <input type=radio name=sitesearch value="castleproject.org" checked> Search castleproject.org
</td></tr></TABLE>
</FORM>
<!-- Search Google -->
</center>
	&nbsp;
	<br/>

		</div> <!-- end of content -->
  </div><!-- end of page -->
  


	<script type="text/javascript">_uacct = "UA-1190612-1";urchinTracker();</script>
	</body>
</html>
