<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">




<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
		<title>How to use it :: Castle Project</title>
		<link rel="stylesheet" href="../../base.css" />
		<link rel="stylesheet" href="../../elem.css" />
		<link rel="stylesheet" href="../../csharp.css" />
	</head>

	<body>

<div id="container">

  <div id="topbuttonscontainer"></div>

  <div id="maintitle">
    <h1> <a href="/" title="Home" accesskey="1">Home</a> </h1>
  </div>

  <div id="mainbar">
    <div id="mainbarleft"><div id="mainbarright"></div></div>
  </div>
  
  <div id="page">
		<div id="sidebar" >
  <div class="lightmenu">
    <div class="lightmenucontent">
<span class="menutitle">
<a href="./../../castle/others/anakia/index.html">Castle Anakia</a>
</span>
  <ul>
<li>
<a href="./../../castle/others/anakia/howitworks.html">How it works</a>
</li>
<li>
<a href="./../../castle/others/anakia/usingit.html">How to use it</a>
</li>
<li>
<a href="./../../castle/others/anakia/formatters.html">Code formatters</a>
</li>
<li>
<a href="./../../castle/others/anakia/sitemapandbd.html">Sitemap and breadcrumbs</a>
</li>
  </ul>
    </div>
  </div>
  <br/>
  <div class="darkmenu">
    <div class="darkmenucontent">
<span class="menutitle">
Navigation
</span>
  <ul>
<li>
Docs for version Beta 4
</li>
<li>
Docs for version Release Candidate 1 
</li>
  </ul>
    </div>
  </div>
  <br/>
			<br/>
		</div>
		
		<div id="content">

		<h1 class="firstHeading">
		    How to use it
		</h1> 
	
<div class="breadcrumbs">
&raquo;
<a href="./index.html">Main Page</a>
&raquo;
<a href="./others/index.html">Other projects</a>
&raquo;
<a href="./others/anakia/index.html">Castle Anakia</a>
&raquo;
<u>How to use it</u>
</div>

		<!-- start content -->

  <p>
There are a few steps involved in getting Anakia working. First you need to create 
the content documents which are simple xml files. The structure is up to you. Then you create
a transformation file, which uses NVelocity syntax. A project file can be used to define
the project menu and content that is used by all pages. Finally an optional navigation file
can be added to each folder, to define a contextual navigation. 
</p><p>
It is assumed that you have a recent version of <a href="http://nant.sourceforge.net/">NAnt</a> 
installed and configured on your environment.
</p>
<!--
-->
		
		
<a name="files"></a>
  <h1>The files</h1>
  <p>
The sections below explain the files and their roles. Bear in mind that they are most a convention
than something enforced by the tool. From Anakia point of view, their are just xml content. It's up
to you to make everything work.
  </p>
<a name="contentfiles"></a>
  <h2>The content files</h2>
  <p>
Each content file defines a content that ultimately will be transformed to a html page. It's up
to you to define the structure, as long as the transformation file matches that structure when 
transforming the content to html.
</p>
  <p>
Castle Anakia site map implementation assumes that you use sections, which can be nested up to three levels. Castle web site uses the structure depicted below: 
</p>
    <pre class="csharpcode">

<span class="kwrd">&lt;?</span><span class="html">xml</span> <span class="attr">version</span><span class="kwrd">="1.0"</span>?<span class="kwrd">&gt;</span>
<span class="kwrd">&lt;</span><span class="html">document</span><span class="kwrd">&gt;</span>
<span class="kwrd">&lt;</span><span class="html">properties</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;</span><span class="html">title</span><span class="kwrd">&gt;</span>Page title<span class="kwrd">&lt;/</span><span class="html">title</span><span class="kwrd">&gt;</span>
<span class="kwrd">&lt;/</span><span class="html">properties</span><span class="kwrd">&gt;</span>
<span class="kwrd">&lt;</span><span class="html">body</span><span class="kwrd">&gt;</span>
  <span class="kwrd">&lt;</span><span class="html">intro</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;</span><span class="html">p</span><span class="kwrd">&gt;</span>Some paragraphs with an introductory explanation<span class="kwrd">&lt;/</span><span class="html">p</span><span class="kwrd">&gt;</span>
  <span class="kwrd">&lt;/</span><span class="html">intro</span><span class="kwrd">&gt;</span>
  
  <span class="kwrd">&lt;</span><span class="html">section</span> <span class="attr">id</span><span class="kwrd">="an optional id"</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;</span><span class="html">title</span><span class="kwrd">&gt;</span>The section title<span class="kwrd">&lt;/</span><span class="html">title</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;</span><span class="html">p</span><span class="kwrd">&gt;</span>Section content paragraph 1<span class="kwrd">&lt;/</span><span class="html">p</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;</span><span class="html">p</span><span class="kwrd">&gt;</span>Section content paragraph 2<span class="kwrd">&lt;/</span><span class="html">p</span><span class="kwrd">&gt;</span>
    
    <span class="kwrd">&lt;</span><span class="html">section</span><span class="kwrd">&gt;</span>
      <span class="kwrd">&lt;</span><span class="html">title</span><span class="kwrd">&gt;</span>A sub section<span class="kwrd">&lt;/</span><span class="html">title</span><span class="kwrd">&gt;</span>
      <span class="kwrd">&lt;</span><span class="html">p</span><span class="kwrd">&gt;</span>Another paragraph<span class="kwrd">&lt;/</span><span class="html">p</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;/</span><span class="html">section</span><span class="kwrd">&gt;</span>
  <span class="kwrd">&lt;/</span><span class="html">section</span><span class="kwrd">&gt;</span>
<span class="kwrd">&lt;/</span><span class="html">body</span><span class="kwrd">&gt;</span>
<span class="kwrd">&lt;/</span><span class="html">document</span><span class="kwrd">&gt;</span>
</pre>
  <a name="projectfile"></a>
  <h2>The index file</h2>
  <p>
The <tt>index.xml</tt> file is a content file that is treated differently by Castle Anakia when generating breadcrumbs and sitemaps. The folder title for example is get from the <tt>index.xml</tt> title property.
</p>
<a name="projectfile"></a>
  <h2>The project file</h2>
  <p>
The <tt>project.xml</tt> file should contain information that is shared by all content pages. For example
common links, or a default menu structure.
</p>
<a name="navfile"></a>
  <h2>The navigation file</h2>
  <p>
The <tt>navigation.xml</tt> file can appear on each folder and should contain contextual information
for the folder and subfolders. For example, it can override the menu, or enhance the 
navigation.
</p>
<a name="navfile"></a>
  <h2>The transformation file</h2>
  <p>
The transformation file is a NVelocity template that needs to transverse the xml document 
and generate the final html.
</p>
<a name="nanttask"></a>
  <h1>Creating a NAnt target</h1>
  <p>
	Once you have some content files, the <tt>project.xml</tt> and the transformation file, you should 
	set a NAnt target to run Castle Anakia. The following is an example of a simple
	build file used by Castle:
	</p>
    <pre class="csharpcode">

<span class="kwrd">&lt;?</span><span class="html">xml</span> <span class="attr">version</span><span class="kwrd">="1.0"</span>?<span class="kwrd">&gt;</span>
<span class="kwrd">&lt;</span><span class="html">project</span> <span class="attr">name</span><span class="kwrd">="castle-website"</span> <span class="attr">default</span><span class="kwrd">="run"</span><span class="kwrd">&gt;</span>

    <span class="kwrd">&lt;</span><span class="html">loadtasks</span> <span class="attr">assembly</span><span class="kwrd">="../AnakiaNet/Anakia/bin/Anakia.dll"</span> <span class="attr">verbose</span><span class="kwrd">="true"</span> <span class="kwrd">/&gt;</span>

    <span class="kwrd">&lt;</span><span class="html">target</span> <span class="attr">name</span><span class="kwrd">="run"</span><span class="kwrd">&gt;</span>
        <span class="kwrd">&lt;</span><span class="html">anakia</span>
            <span class="attr">navigationfile</span><span class="kwrd">="navigation.xml"</span>
            <span class="attr">templatefile</span><span class="kwrd">="site.vsl"</span>
            <span class="attr">projectfile</span><span class="kwrd">="project.xml"</span>
            <span class="attr">targetdir</span><span class="kwrd">="website"</span>
            <span class="kwrd">&gt;</span>
            
            <span class="kwrd">&lt;</span><span class="html">source</span> <span class="attr">basedir</span><span class="kwrd">="xdocs"</span><span class="kwrd">&gt;</span>
                <span class="kwrd">&lt;</span><span class="html">include</span> <span class="attr">name</span><span class="kwrd">="**.*"</span> <span class="kwrd">/&gt;</span>
                
                <span class="kwrd">&lt;</span><span class="html">exclude</span> <span class="attr">name</span><span class="kwrd">="**/project.xml"</span> <span class="kwrd">/&gt;</span>
                <span class="kwrd">&lt;</span><span class="html">exclude</span> <span class="attr">name</span><span class="kwrd">="**/*.vsl"</span> <span class="kwrd">/&gt;</span>
                <span class="kwrd">&lt;</span><span class="html">exclude</span> <span class="attr">name</span><span class="kwrd">="**/*.dtd"</span> <span class="kwrd">/&gt;</span>
            <span class="kwrd">&lt;/</span><span class="html">source</span><span class="kwrd">&gt;</span>
        <span class="kwrd">&lt;/</span><span class="html">anakia</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;/</span><span class="html">target</span><span class="kwrd">&gt;</span>

<span class="kwrd">&lt;/</span><span class="html">project</span><span class="kwrd">&gt;</span>
</pre>
    <p>
When running NAnt you should have something like the following output:
</p>
  <pre class="commonpre">
  
NAnt 0.85 (Build 0.85.2344.0; rc4; 6/2/2006)
Copyright (C) 2001-2006 Gerry Shaw
http://nant.sourceforge.net

Buildfile: file:///site/default.build
Target framework: Microsoft .NET Framework 1.1
Target(s) specified: run

[loadtasks] Scanning assembly "Anakia" for extensions.

run:

No index.xml found for folder castle/container/microkernel
No index.xml found for folder castle/container/microkernel/documentation

BUILD SUCCEEDED

Total time: 0.9 seconds.

  </pre>
  <p>
Only xml files will be processed. All others that match NAnt file set is considered
a static file and will be copied to the target folder if a change is detected 
(source file is newer than target file).
</p>
  <p>
If you want to skip files, use the exclusion on the file set definition.
</p>
		
		<!-- end content -->
		
	<div id="footer">

	Found an error? Something inaccurate? <a href="">Help us improve the documentation</a> <br/>
	Generated by <a href="">Castle Anakia</a>

	</div>

	&nbsp;
	<br/>

		</div> <!-- end of content -->
  </div><!-- end of page -->
  
</div>

	</body>
</html>
