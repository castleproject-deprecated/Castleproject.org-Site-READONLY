<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">









<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
		<title>Using NVelocity :: Castle Project</title>
		<link rel="stylesheet" href="../../base.css" />
		<link rel="stylesheet" href="../../front.css" />
		<link rel="stylesheet" href="../../elem.css" />
		<link rel="stylesheet" href="../../csharp.css" />
		<link rel="stylesheet" href="../../TAB_styles.css" />
		<script type="text/javascript" src="../../mktree.js"></script>
		<script type="text/javascript" src="../../TAB_Function_Lib.js"></script>
	</head>

	<body>
<div id="topheader">
  <div id="maintitle">
	<h1> <a href="../../index.html" title="Castle Project Home" accesskey="1">Home</a> </h1>
	<h2> <a href="http://www.castlestronghold.com" title="Castle Stronghold: support, consulting and development">Castle Stronghold</a> </h2>
  </div>
  <div id="mainbar">
	<ul id="toplinks">
		<li>&nbsp;</li>
		<li><a style="_width: 70px;" href="../../index.html">Home</a></li>
		<li><a style="_width: 70px;" href="../../castle/download.html">Download</a></li>
		<li><a style="_width: 50px;" href="http://wiki.castleproject.org">Wiki</a></li>
		<li><a style="_width: 60px;" href="../../community/forum.html">Forum</a></li>
		<li><a style="_width: 100px;" href="../../jira.html">Issue Tracker</a></li>
		<li><a style="_width: 80px;" href="../../irc.html">IRC Channel</a></li>
		<li><a style="_width: 80px;" href="http://builds.castleproject.org">Build Server</a></li>
	</ul>
  </div>
</div>



<div id="coolpage">

	<div id="sidebar" >
		
  <div class="lightmenu">
    <div class="lightmenucontent">
<span class="menutitle">
<a href="./../../others/nvelocity/index.html">NVelocity</a>
</span>
  <ul>
<li>
<a href="./../../others/nvelocity/improvements.html">Improvements</a>
</li>
<li>
<a href="./../../others/nvelocity/usingit.html">Using it</a>
</li>
<li>
<a href="./../../others/nvelocity/problems.html">Caveats and Problems</a>
</li>
  </ul>
    </div>
  </div>
  <br/>
  <div class="darkmenu">
    <div class="darkmenucontent">
<span class="menutitle">
Navigation
</span>
  <ul>
<li>
<a href="./../../index.html">Back to Main Page</a>
</li>
  </ul>
    </div>
  </div>
  <br/>
	<br/>
	
	</div>
		
	<div id="content">
	
		<div class="callout-pic">

<!-- Begin Table of contents -->
<div id="toc">
<h2>Table of contents</h2>
<ul>
<li class='toclevel-1'><a href="#step1"><span class="tocnumber">1</span> <span class="toctext">Step 1 - Creating a VelocityEngine</span></a>
</li>
<li class='toclevel-1'><a href="#step2"><span class="tocnumber">2</span> <span class="toctext">Step 2 - Creating the Template</span></a>
</li>
<li class='toclevel-1'><a href="#step3"><span class="tocnumber">3</span> <span class="toctext">Step 3 - Merging the template</span></a>
</li>
</ul>
</div>
<!-- End Table of contents -->
		</div>

		<h1 class="firstHeading">
		    Using NVelocity
		</h1> 
	
<div class="breadcrumbs">
&raquo;
	<a href="./../../index.html">Home</a> 
&raquo;
	<a href="./../../others/index.html">Other projects</a> 
&raquo;
	<a href="./../../others/nvelocity/index.html">NVelocity</a> 
&raquo;
<u>Using NVelocity</u>
</div>

		<!-- start content -->
<p>
This is a very basic instruction on getting NVelocity working. 
Basically you need an engine instance and one or more templates. 
The result of the process is known as the merge of the template
with a context (ie the data).
</p><p>
For simplicity's sake, we will use e-mail template as example.
</p><a name="step1"></a>
  <h1>Step 1 - Creating a VelocityEngine</h1>
<p>
	First you must have an engine instance. 
	You can initialize an instance with several properties that 
	dictate the NVelocity behavior regarding encoding, cache and other things.
	</p>    <pre class="csharpcode">

<span class="kwrd">using</span> Commons.Collections;
<span class="kwrd">using</span> NVelocity;
<span class="kwrd">using</span> NVelocity.App;
<span class="kwrd">using</span> NVelocity.Context;

...

VelocityEngine velocity = <span class="kwrd">new</span> VelocityEngine();

ExtendedProperties props = <span class="kwrd">new</span> ExtendedProperties();
velocity.Init(props);</pre>
  <p>
	First you must have an engine instance. 
	You can initialize an instance with several properties that 
	dictate the NVelocity behavior regarding encoding, cache and other things.
	</p><a name="step2"></a>
  <h1>Step 2 - Creating the Template</h1>
<p>
	The template is created by the engine from a file. Assuming that
	we are producing an e-mail template, let's create something simple:
	</p>    <pre class="csharpcode">

From: $from
To: $to
Subject: $subject

Hello $customer.Name

We're please to yada yada yada.</pre>
  <p>
	Save the content above to a file and use its absolute path in the line
	below in your C# code:
	</p>    <pre class="csharpcode">

Template template = velocity.GetTemplate(<span class="str">@"path/to/myfirsttemplate.vm"</span>);</pre>
  <a name="step3"></a>
  <h1>Step 3 - Merging the template</h1>
<p>
	Merging is the process of combining the data with the 
	template instructions to create the resulting content. You make
	data available to the template using a context.
	</p>    <pre class="csharpcode">

VelocityContext context = <span class="kwrd">new</span> VelocityContext();
context.Put(<span class="str">"from"</span>, <span class="str">"somewhere"</span>);
context.Put(<span class="str">"to"</span>, <span class="str">"someone"</span>);
context.Put(<span class="str">"subject"</span>, <span class="str">"Welcome to NVelocity"</span>);
context.Put(<span class="str">"customer"</span>, <span class="kwrd">new</span> Customer(<span class="str">"John Doe"</span>) );</pre>
  <p>
	Finally create a writer to output the content.
	The code below uses simply a <tt>StringWriter</tt>:
	</p>    <pre class="csharpcode">

StringWriter writer = <span class="kwrd">new</span> StringWriter();
template.Merge(context, writer);
Console.WriteLine(writer.GetStringBuilder().ToString());</pre>
  <p>
	You see the merged result in the console if you used the code above.
	</p>		<!-- end content -->
		
	<div id="footer">
	Found an error? Something inaccurate? 
	<a href="../../community/getinvolved.html">Help us improve the documentation</a> <br/>
	Generated by <a href="../../others/anakia/index.html">Castle Anakia</a>. 
	
	<p>&nbsp;</p>
	
	<p>
	Sponsored by <img src="../../images/logothumb.gif" /> <a href="http://www.castlestronghold.com">Castle Stronghold</a>.
	</p>
	
	</div>

	&nbsp;
	<br/>

		</div> <!-- end of content -->
  </div><!-- end of page -->
  


	</body>
</html>
