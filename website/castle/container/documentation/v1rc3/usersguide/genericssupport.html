<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">









<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
		<title>.Net 2 Generics support :: Castle Project</title>
		<link rel="stylesheet" href="../../../../base.css" />
		<link rel="stylesheet" href="../../../../front.css" />
		<link rel="stylesheet" href="../../../../elem.css" />
		<link rel="stylesheet" href="../../../../csharp.css" />
		<link rel="stylesheet" href="../../../../TAB_styles.css" />
		<script type="text/javascript" src="../../../../mktree.js"></script>
		<script type="text/javascript" src="../../../../TAB_Function_Lib.js"></script>
		<script src="http://www.google-analytics.com/urchin.js" type="text/javascript"></script>
	</head>

	<body>
<div id="topheader">
  <div id="maintitle">
	<h1> <a href="../../../../index.html" title="Castle Project Home" accesskey="1">Home</a> </h1>
	<h2> <a href="http://www.castlestronghold.com" title="Castle Stronghold: support, consulting and development">Castle Stronghold</a> </h2>
  </div>
  <div id="mainbar">
	<ul id="toplinks">
		<li>&nbsp;</li>
		<li><a style="_width: 70px;" href="../../../../index.html">Home</a></li>
		<li><a style="_width: 70px;" href="../../../../castle/download.html">Download</a></li>
		<li><a style="_width: 110px;" href="http://api.castleproject.org">API Doc</a></li>
		<li><a style="_width: 50px;" href="http://using.castleproject.org">Using</a></li>
		<li><a style="_width: 60px;" href="../../../../community/forum.html">Forum</a></li>
		<li><a style="_width: 120px;" href="../../../../issuetracker.html">Issue Tracker</a></li>
		<li><a style="_width: 110px;" href="http://builds.castleproject.org">Builds</a></li>
	</ul>
  </div>
</div>



<div id="coolpage">

	<div id="sidebar" >
		
  <div class="lightmenu">
    <div class="lightmenucontent">
<span class="menutitle">
<a href="./../../../../container/index.html">MicroKernel/Windsor</a>
</span>
  <ul>
<li>
<a href="./../../../../container/gettingstarted/index.html">Getting started</a>
</li>
<li>
<a href="./../../../../container/documentation/index.html">Documentation</a>
</li>
<li>
<a href="./../../../../container/facilities/index.html">Facilities</a>
</li>
<li>
<a href="./../../../../container/services/index.html">Services</a>
</li>
<li>
<a href="./../../../../container/faq.html">FAQ</a>
</li>
<li>
<a href="./../../../../container/recipes/index.html">Recipes</a>
</li>
<li>
<a href="./../../../../container/externalarticles.html">External Articles</a>
</li>
<li>
<a href="./../../../../container/roadmap.html">Roadmap</a>
</li>
  </ul>
    </div>
  </div>
  <br/>
  <div class="lightmenu">
    <div class="lightmenucontent">
<span class="menutitle">
<a href="./../../../../container/documentation/v1rc3/index.html">Documentation</a>
</span>
  <ul>
<li>
<a href="./../../../../container/documentation/v1rc3/releasenotes/index.html">Release notes</a>
</li>
<li>
<a href="./../../../../container/documentation/v1rc3/concepts/index.html">Concepts</a>
</li>
<li>
<a href="./../../../../container/documentation/v1rc3/samples/index.html">Samples</a>
</li>
<li>
<a href="./../../../../container/documentation/v1rc3/manual/index.html">Reference Manual</a>
</li>
<li>
<a href="./../../../../container/documentation/v1rc3/usersguide/index.html">User's Guide</a>
</li>
<li>
<a href="./../../../../container/documentation/v1rc3/advanced/index.html">Advanced usage</a>
</li>
  </ul>
    </div>
  </div>
  <br/>
  <div class="darkmenu">
    <div class="darkmenucontent">
<span class="menutitle">
Navigation
</span>
  <ul>
<li>
<a href="./../../../../index.html">Back to Main Page</a>
</li>
  </ul>
    </div>
  </div>
  <br/>
	<br/>
	
	</div>
		
	<div id="content">
	
		<div class="callout-pic">

<!-- Begin Table of contents -->
<div id="toc">
<h2>Table of contents</h2>
<ul>
<li class='toclevel-1'><a href="#resolvegeneric"><span class="tocnumber">1</span> <span class="toctext">The Resolve<> method</span></a>
</li>
<li class='toclevel-1'><a href="#withargs"><span class="tocnumber">2</span> <span class="toctext">Registering a generic type with arguments</span></a>
</li>
<li class='toclevel-1'><a href="#withoutargs"><span class="tocnumber">3</span> <span class="toctext">Registering a generic type without arguments</span></a>
<ul>
	<li class='toclevel-1'><a href="#guessing"><span class="tocnumber">3.1</span> <span class="toctext">Guessing the generic argument</span></a>
</li>
</ul>
</li>
</ul>
</div>
<!-- End Table of contents -->
		</div>

		<h1 class="firstHeading">
		    .Net 2 Generics support
		</h1> 
	
<div class="breadcrumbs">
&raquo;
	<a href="./../../../../index.html">Home</a> 
&raquo;
	<a href="./../../../../container/index.html">MicroKernel/Windsor</a> 
&raquo;
	<a href="./../../../../container/documentation/index.html">Documentation</a> 
&raquo;
	<a href="./../../../../container/documentation/v1rc3/index.html">RC3 Documentation</a> 
&raquo;
	<a href="./../../../../container/documentation/v1rc3/usersguide/index.html">User's guide</a> 
&raquo;
<u>.Net 2 Generics support</u>
</div>

		<!-- start content -->
<p>
Since the RC3 release, the MicroKernel has support for generic types, which
allows you to register generic types bound or not bound to generic arguments.
The unbound types will be constructed using the type arguments
provided by you or using a clever approach to inherit the arguments.
</p>  <div class="warning">
<div class="warningtopbg">
<div class="warningborderleft">
<div class="warningborderright">
<div class="warningtopleft">
<div class="warningtopright">
<div class="warningbottomleft">
<div class="warningbottomright">
	<div class="boxtitle">Warning</div>
<div class="innercontent">
<p>
Due to a limitation in DynamicProxy (version 1.1.5) 
an interceptor cannot be associated with a generic type.
 This limitation was fixed on the new DynamicProxy 2.0
but at the time of writing, it was still unstable to be included in 
the release.
</p>
</div></div></div></div></div></div></div></div></div>
<a name="resolvegeneric"></a>
  <h1>The Resolve&lt;&gt; method</h1>
<p>
	If you use the Windsor Container compiled
	for .Net 2.0 you will see that it exposes a
	Resolve<> method overload that saves you from casting 
	the component instance before using. For example:
	</p>    <pre class="csharpcode">

<span class="rem">// You can use    </span>

IEmailSender sender = container.Resolve&lt;IEmailSender&gt;();

<span class="rem">// instead of</span>

IEmailSender sender = (IEmailSender) container[<span class="kwrd">typeof</span>(IEmailSender)];
</pre>
  <a name="withargs"></a>
  <h1>Registering a generic type with arguments</h1>
<p>
	By "type with arguments" we mean that the generic types are 
	already bound. Consider the following interface and class:
	</p>    <pre class="csharpcode">

<span class="kwrd">public</span> <span class="kwrd">interface</span> IRepository&lt;T&gt;
{
    T Get(<span class="kwrd">int</span> id);
}

<span class="kwrd">public</span> <span class="kwrd">class</span> Repository&lt;T&gt; : IRepository&lt;T&gt;
{
    <span class="kwrd">public</span> T Get(<span class="kwrd">int</span> id)
    {
        <span class="kwrd">return</span> Activator.CreateInstance&lt;T&gt;();
    }
}</pre>
  <p>
	Both are generic types. You can configure them as a
	component using the standard .Net notation for generic types:
	</p>    <pre class="csharpcode">

<span class="kwrd">&lt;</span><span class="html">component</span> 
    <span class="attr">id</span><span class="kwrd">='int.repos.generic'</span> 
    <span class="attr">service</span><span class="kwrd">='Namespace.IRepository`1[[System.Int32]], AssemblyName'</span> 
    <span class="attr">type</span><span class="kwrd">='Namespace.Repository`1[[System.Int32]], AssemblyName'</span> <span class="kwrd">/&gt;</span>
    </pre>
  <p>
	With the configuration above Windsor will treat the component
	as an ordinary component. If another component has a 
	dependency on it, it must use the exact same generic arguments.
	For example:
	</p>    <pre class="csharpcode">

<span class="kwrd">public</span> <span class="kwrd">class</span> PrimeNumberHolder
{
    <span class="kwrd">private</span> IRepository&lt;<span class="kwrd">int</span>&gt; intRepository;

    <span class="kwrd">public</span> PrimeNumberHolder(IRepository&lt;<span class="kwrd">int</span>&gt; intRepository)
    {
        <span class="kwrd">this</span>.intRepository = intRepository;
    }
}</pre>
  <a name="withoutargs"></a>
  <h1>Registering a generic type without arguments</h1>
<p>
	Continuing to use the example above, we can also register the 
	unbound type. For example:
	</p>    <pre class="csharpcode">

<span class="kwrd">&lt;</span><span class="html">component</span> 
    <span class="attr">id</span><span class="kwrd">='int.repos.generic'</span> 
    <span class="attr">service</span><span class="kwrd">='Namespace.IRepository`1, AssemblyName'</span> 
    <span class="attr">type</span><span class="kwrd">='Namespace.Repository`1, AssemblyName'</span> <span class="kwrd">/&gt;</span>
    </pre>
  <p>
	Now Windsor realizes that in order to create
	the component instance registered above it needs a
	generic argument. You can specify the type using the <tt>Resolve</tt>
	method or requesting the service with the parameter:
	</p>    <pre class="csharpcode">

IRepository&lt;Employee&gt; empRepost = 
    container[<span class="kwrd">typeof</span>(IRepository&lt;Employee&gt;)] <span class="kwrd">as</span> IRepository&lt;Employee&gt;;

<span class="rem">// or </span>

IRepository&lt;Employee&gt; empRepost = 
    container.Resolve&lt;IRepository&lt;Employee&gt;&gt;();
    </pre>
  <a name="guessing"></a>
  <h2>Guessing the generic argument</h2>
<p>
	Windsor is also able to guess 
	the generic argument. This only happens if the component
	request dependency is a generic type itself, and the generic 
	types were given for it. All it does is use the same generic
	types on all dependency requested in the chain. For example, consider
	the following components:
	</p>    <pre class="csharpcode">

<span class="kwrd">public</span> <span class="kwrd">class</span> A&lt;T&gt;
{
    <span class="kwrd">public</span> A(B&lt;T&gt; b)
    {
    }
}

<span class="kwrd">public</span> <span class="kwrd">class</span> B&lt;T&gt;
{
    <span class="kwrd">public</span> B()
    {
    }
}</pre>
  <p>
	Component A depends on B. Both are generic types. The 
	following configuration snippet registers both without any 
	generic parameter:
	</p>    <pre class="csharpcode">

<span class="kwrd">&lt;</span><span class="html">component</span> 
    <span class="attr">id</span><span class="kwrd">='compA'</span> 
    <span class="attr">type</span><span class="kwrd">='Namespace.A`1, AssemblyName'</span> <span class="kwrd">/&gt;</span>

<span class="kwrd">&lt;</span><span class="html">component</span> 
    <span class="attr">id</span><span class="kwrd">='compB'</span> 
    <span class="attr">type</span><span class="kwrd">='Namespace.B`1, AssemblyName'</span> <span class="kwrd">/&gt;</span>
    </pre>
  <p>
	If you request the component A passing an int as the generic
	argument, B will be constructed with an int generic argument too:
	</p>    <pre class="csharpcode">

A&lt;<span class="kwrd">int</span>&gt; componentA = container.Resolve&lt;A&lt;<span class="kwrd">int</span>&gt;&gt;();
    </pre>
  <p>
	What if the component A was registered bound to a type?
	</p>    <pre class="csharpcode">

<span class="kwrd">&lt;</span><span class="html">component</span> 
    <span class="attr">id</span><span class="kwrd">='compA'</span> 
    <span class="attr">type</span><span class="kwrd">='Namespace.A`1[[System.Int32]], AssemblyName'</span> <span class="kwrd">/&gt;</span>

<span class="kwrd">&lt;</span><span class="html">component</span> 
    <span class="attr">id</span><span class="kwrd">='compB'</span> 
    <span class="attr">type</span><span class="kwrd">='Namespace.B`1, AssemblyName'</span> <span class="kwrd">/&gt;</span>
    </pre>
  <p>
	This is also supported, and B will be created using the Int32 as
	the generic argument.
	</p>		<!-- end content -->
		
	<div id="footer">
<script type="text/javascript"><!--
google_ad_client = "pub-2091974950947714";
/* 728x90, created 2/13/08 */
google_ad_slot = "5378217716";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
	
	<br/>
	Found an error? Something inaccurate? 
	<a href="../../../../community/getinvolved.html">Help us improve the documentation</a> <br/>
	Generated by <a href="../../../../others/anakia/index.html">Castle Anakia</a>. 
	
	<p>&nbsp;</p>
	
	<p>
	Sponsored by <img src="../../../../images/logothumb.gif" /> <a href="http://www.castlestronghold.com">Castle Stronghold</a>.
	</p>
	
	</div>

	<!-- Search Google -->
<center>
<FORM method=GET action="http://www.google.com/custom">
<TABLE bgcolor="#FFFFFF" cellspacing="4" border="0" style="border: solid 1px gray;" align="center">
<tr valign=top><td>
<A HREF="http://www.google.com/search">
<IMG SRC="http://www.google.com/logos/Logo_40wht.gif" border=0 ALT=Google align=middle></A>
</td>
<td>
<INPUT TYPE=text name=q size=31 maxlength=255 value="">
<INPUT type=submit name=sa VALUE="Google Search">
<INPUT type=hidden name=cof VALUE="S:http://www.castlestronghold.com;GL:1;VLC:#373737;AH:center;LH:63;LC:#0A50A1;GFNT:#5B5B5B;L:http://www.castleproject.org/images/castle-logo.gif;ALC:#0A50A1;BIMG:http://www.castleproject.org/images/bg.png;LW:280;T:#5B5B5B;AWFID:3d565acacdd9f388;">
<input type=hidden name=domains value="castleproject.org"><br><input type=radio name=sitesearch value=""> Search WWW <input type=radio name=sitesearch value="castleproject.org" checked> Search castleproject.org
</td></tr></TABLE>
</FORM>
<!-- Search Google -->
</center>
	&nbsp;
	<br/>

		</div> <!-- end of content -->
  </div><!-- end of page -->
  


	<script type="text/javascript">_uacct = "UA-1190612-1";urchinTracker();</script>
	</body>
</html>
